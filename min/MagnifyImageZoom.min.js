/*! 
    MagnifyImageZoom    Copyright (C) 2020 AonaSuzutsuki.
    MIT License
*/

function MagnifyImageZoom(e,t,i){const n=e,l=t,h=i;let d=0,g=0,c=1,o=1,m=1,s=1,r=0,y=0,a=!1;this.setHoverImage=(async()=>{let e=document.getElementById(n),t=document.getElementById(l),h=e.src,u=await(e=>new Promise((t,i)=>{const n=new Image;n.onload=(()=>t(n)),n.onerror=(e=>i(e)),n.src=e}))(e.src);if(r=u.width,y=u.height,!(a=(e=>r>e.width&&y>e.height)(e)))return;d=t.clientWidth/2,g=t.clientHeight/2,c=u.width/e.clientWidth,o=u.height/e.clientHeight,m=e.clientWidth/u.width,s=e.clientHeight/u.height,t.style.backgroundImage="url('"+h+"')",t.style.backgroundSize=`${u.width}px ${u.height}px`;let p=document.getElementById(i);p.style.width=`${t.clientWidth*m}px`,p.style.height=`${t.clientHeight*s}px`}),this.refreshHoverImage=(e=>{let t=document.getElementById(n),i=document.getElementById(l),u=document.getElementById(h);if(!a)return;let p=(e=>{let t=document.getElementById(n);e=e||window.event;let i=t.getBoundingClientRect(),l=e.pageX-i.left,h=e.pageY-i.top;return{x:l-=window.pageXOffset,y:h-=window.pageYOffset}})(e),w=p.x*c-d,f=p.y*o-g,I=p.x-d*m,x=p.y-g*s;w<0&&(w=0,I=0),f<0&&(f=0,x=0),w+i.clientWidth>=r&&(w=r-i.clientWidth,I=t.clientWidth-i.clientWidth*m),f+i.clientHeight>=y&&(f=y-i.clientHeight,x=t.clientHeight-i.clientHeight*s),i.style.backgroundPosition=`top ${-f}px left ${-w}px`,u.style.left=`${I}px`,u.style.top=`${x}px`}),this.canZoom=(()=>a)}
